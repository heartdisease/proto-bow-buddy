<!--
This file is part of BowBuddy.

BowBuddy is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

BowBuddy is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with BowBuddy.  If not, see <http://www.gnu.org/licenses/>.


Copyright 2017 Christoph Matscheko
-->
<!DOCTYPE html>
<html class="no-js" lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<title>BowBuddy 1.0 (Prototype)</title>
		<meta name="author" content="Christoph Matscheko" />
		<meta name="description" content="An app for keeping track of your score in archery" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/main.css" />
		<style>
			body {
				padding-top: 10px;
				padding-bottom: 20px;
			}
			
			#main {
				text-align: center;
			}
			
			.app-logo {
				margin-bottom: 45px;
			}
		
			
			.main-menu > a {
				display: block;
				clear: both;
				width: 250px;
				margin-bottom: 15px;
				margin-left: auto;
				margin-right: auto;
			}
			
			.main-menu > a > span.glyphicon {
				top: 2px;
				left: -4px;
			}
		</style>
		<link rel="stylesheet" href="css/bootstrap-theme.min.css">
		<script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
	</head>
	<body>
		<div class="container" id="main">
			<div class="app-logo">
				<h1>BowBuddy 1.0 (Prototype)</h1>
			</div>

			<div class="container-fluid main-menu">
				<a class="btn btn-success btn-lg" href="views/new-game.html" role="button"><span class="glyphicon glyphicon-screenshot" aria-hidden="true"></span> New Game</a>
				<a class="btn btn-primary btn-lg" href="#" role="button" disabled><span class="glyphicon glyphicon-cog" aria-hidden="true"></span> Course Settings</a>
				<a class="btn btn-primary btn-lg" href="#" role="button" disabled><span class="glyphicon glyphicon-cog" aria-hidden="true"></span> Player Settings</a>
				<a class="btn btn-primary btn-lg" href="#" role="button" disabled><span class="glyphicon glyphicon-signal" aria-hidden="true"></span> Hall Of Fame</a>
				<a class="btn btn-danger btn-lg" href="#" role="button" id="quit-btn"><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span> Quit</a>
			</div>
			
			<div class="modal fade" tabindex="-1" role="dialog" id="delete-db-modal">
				<div class="modal-dialog modal-sm" role="document">
					<div class="modal-content">
						<span class="modal-msg"></span>
						
						<a type="button" class="btn btn-default" data-dismiss="modal">Close</a>
					</div>
				</div>
			</div>
		</div>
		
		<script src="js/vendor/jquery-1.11.2.min.js"></script>
		<script src="js/vendor/bootstrap.min.js"></script>
		<script src="js/main.js"></script>
		<script>
			$(function(){
				let logoCounter = 0;
				let quitCounter = 0;
			
				$(".app-logo")
					.on("click", BowBuddy.switchToFullscreenFunc())
					.on("click", (e) => {
						if (++logoCounter % 3 === 0) {
							BowBuddy.storage.dump()
								.then((dbObject) => {
									const dbDump = JSON.stringify(dbObject);
									const $textarea = $("<textarea/>")
										.css({ "margin-top": "14px", "margin-bottom": "14px", "font-family": "monospace"})
										.attr("rows", "25")
										.attr("cols", "35")
										.text(dbDump)
										.insertBefore($("#delete-db-modal a.btn").css("display", "block"));
									
									console.log("BowBuddyDb dump:");
									console.log(dbObject); // show db object in console for close inspection
									
									$("#delete-db-modal .modal-msg").empty();
									$("#delete-db-modal").modal('show');	
									window.setTimeout(() => $textarea.select(), 500);
								});
						}
					});
				$("#quit-btn").on("click", (e) => {
					if (++quitCounter % 4 === 0 && window.confirm("Are you sure you want to erase the entire database?")) {
						BowBuddy.storage.erase()
							.then((e) => {
								$("#delete-db-modal .modal-msg").text("Database was successfully deleted!");
							})
							.catch((e) => {
								$("#delete-db-modal .modal-msg").text("Failed to delete database!");
							})
							.then(() => {
								$("#delete-db-modal").modal('show');
							});
					}
				});
			});
		</script>
	</body>
</html>
